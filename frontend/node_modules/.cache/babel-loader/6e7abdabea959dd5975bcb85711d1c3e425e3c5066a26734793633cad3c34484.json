{"ast":null,"code":"var _jsxFileName = \"/Users/ayushi/Desktop/repos/nexpert-frontend/src/components/Graph.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport Tree from 'react-d3-tree';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { NodeContext } from '../NodeContext.js';\nimport { getLongDescription, expandGraphWithNewNodes } from '../api/apiCalls.js'; // or wherever your API functions are stored\nimport './styles/Graph.css';\n\n// Helper functions\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction mergeData(nodeId, treeData, expandedData) {\n  // Function to recursively search for a node\n  function findNode(node) {\n    if (node.id === nodeId) {\n      var _node$children;\n      // Node found, append children\n      node.children = (_node$children = node.children) === null || _node$children === void 0 ? void 0 : _node$children.concat(expandedData);\n    } else if (node.children) {\n      // Node not found, search children\n      node.children.forEach(findNode);\n    }\n  }\n\n  // Make a deep copy of the tree data and search it\n  const newTreeData = cloneDeep(treeData);\n  findNode(newTreeData);\n  return newTreeData;\n}\n\n// Function to recursively update node description\nfunction updateDescription(node, currentNode, longDescription) {\n  if (node.id === currentNode.id) {\n    // Return a new object for the node\n    return {\n      ...node,\n      description: longDescription\n    };\n  }\n  if (node.children) {\n    // Iterate through children, creating new objects for any that have changed\n    return {\n      ...node,\n      children: node.children.map(child => updateDescription(child, currentNode, longDescription))\n    };\n  }\n  // No changes to this node or its children\n  return node;\n}\n;\nconst getLongDesc = (node, callbackFunc, activeVar) => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const paperInsights = await getLongDescription(node); // Add any necessary arguments\n      // Update node description in treeData\n      const updatedTreeData = updateDescription(activeVar, node.data, paperInsights === null || paperInsights === void 0 ? void 0 : paperInsights.expandedDescription);\n      callbackFunc(updatedTreeData);\n      resolve(updatedTreeData); // Return the updated data\n    } catch (error) {\n      reject(error);\n    }\n  });\n};\nconst expandGraph = async (node, callbackFunc, activeVar) => {\n  const expandedGraphData = await expandGraphWithNewNodes(node.data.id);\n  const newTreeData = mergeData(node.data.id, activeVar, expandedGraphData);\n  callbackFunc(newTreeData);\n};\n\n// Main component\nconst Graph = () => {\n  _s();\n  const {\n    scale,\n    translate,\n    handleNodeClick,\n    currentNode,\n    setLoading,\n    treeData,\n    setTreeData\n  } = useContext(NodeContext);\n  useEffect(() => {\n    if (!currentNode) return;\n    const fetchData = async () => {\n      try {\n        if (currentNode && currentNode.data) {\n          setLoading(true);\n          const updatedTreeData = await getLongDesc(currentNode, setTreeData, treeData);\n          await expandGraph(currentNode, setTreeData, updatedTreeData);\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('An error occurred while fetching data:', error);\n      }\n    };\n    fetchData();\n  }, [currentNode]);\n  const onClick = nodeData => {\n    handleNodeClick(nodeData);\n  };\n  const [hoveredNode, setHoveredNode] = useState(null);\n  const handleMouseOver = (event, node) => {\n    setHoveredNode(node);\n  };\n  const handleMouseOut = () => {\n    setHoveredNode(null);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"graph\",\n    style: {\n      transform: `scale(${scale})`\n    },\n    children: treeData && /*#__PURE__*/_jsxDEV(Tree, {\n      data: treeData,\n      translate: translate,\n      onNodeClick: onClick,\n      separation: {\n        siblings: 1,\n        nonSiblings: 1\n      }\n      // pathFunc=\"step\"\n      ,\n      rootNodeClassName: \"node__root\",\n      branchNodeClassName: \"node__branch\",\n      leafNodeClassName: \"node__leaf\",\n      onMouseOver: handleMouseOver,\n      onMouseOut: handleMouseOut,\n      nodeLabelComponent: {\n        render: /*#__PURE__*/_jsxDEV(CustomNodeLabel, {\n          hoveredNode: hoveredNode\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 21\n        }, this),\n        foreignObjectWrapper: {\n          x: -50,\n          y: -50\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 5\n  }, this);\n};\n_s(Graph, \"tm3zv5STZv/5gkY15lXI6WO+E3w=\");\n_c = Graph;\nconst CustomNodeLabel = ({\n  nodeData,\n  hoveredNode\n}) => {\n  const isHovered = nodeData === hoveredNode;\n  const size = isHovered ? 20 : 10;\n  const fontSize = isHovered ? '16px' : '12px';\n  return /*#__PURE__*/_jsxDEV(\"foreignObject\", {\n    width: size,\n    height: size,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        width: '100%',\n        height: '100%'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          fontSize,\n          color: isHovered ? 'red' : 'black'\n        },\n        children: nodeData.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 5\n  }, this);\n};\n_c2 = CustomNodeLabel;\nexport default Graph;\nvar _c, _c2;\n$RefreshReg$(_c, \"Graph\");\n$RefreshReg$(_c2, \"CustomNodeLabel\");","map":{"version":3,"names":["React","useContext","useEffect","useState","Tree","cloneDeep","NodeContext","getLongDescription","expandGraphWithNewNodes","jsxDEV","_jsxDEV","mergeData","nodeId","treeData","expandedData","findNode","node","id","_node$children","children","concat","forEach","newTreeData","updateDescription","currentNode","longDescription","description","map","child","getLongDesc","callbackFunc","activeVar","Promise","resolve","reject","paperInsights","updatedTreeData","data","expandedDescription","error","expandGraph","expandedGraphData","Graph","_s","scale","translate","handleNodeClick","setLoading","setTreeData","fetchData","console","onClick","nodeData","hoveredNode","setHoveredNode","handleMouseOver","event","handleMouseOut","className","style","transform","onNodeClick","separation","siblings","nonSiblings","rootNodeClassName","branchNodeClassName","leafNodeClassName","onMouseOver","onMouseOut","nodeLabelComponent","render","CustomNodeLabel","fileName","_jsxFileName","lineNumber","columnNumber","foreignObjectWrapper","x","y","_c","isHovered","size","fontSize","width","height","display","justifyContent","alignItems","color","name","_c2","$RefreshReg$"],"sources":["/Users/ayushi/Desktop/repos/nexpert-frontend/src/components/Graph.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport Tree from 'react-d3-tree';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { NodeContext } from '../NodeContext.js';\nimport { getLongDescription, expandGraphWithNewNodes } from '../api/apiCalls.js'; // or wherever your API functions are stored\nimport './styles/Graph.css';\n\n// Helper functions\nfunction mergeData(nodeId, treeData, expandedData) {\n  // Function to recursively search for a node\n  function findNode(node) {\n    if (node.id === nodeId) {\n      // Node found, append children\n      node.children = node.children?.concat(expandedData);\n    } else if (node.children) {\n      // Node not found, search children\n      node.children.forEach(findNode);\n    }\n  }\n\n  // Make a deep copy of the tree data and search it\n  const newTreeData = cloneDeep(treeData);\n  findNode(newTreeData);\n\n  return newTreeData;\n}\n\n// Function to recursively update node description\nfunction updateDescription(node, currentNode, longDescription) {\n  if (node.id === currentNode.id) {\n    // Return a new object for the node\n    return { ...node, description: longDescription };\n  }\n  if (node.children) {\n    // Iterate through children, creating new objects for any that have changed\n    return {\n      ...node,\n      children: node.children.map(child => updateDescription(child, currentNode, longDescription)),\n    };\n  }\n  // No changes to this node or its children\n  return node;\n};\n\nconst getLongDesc = (node, callbackFunc, activeVar) => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const paperInsights = await getLongDescription(node); // Add any necessary arguments\n      // Update node description in treeData\n      const updatedTreeData = updateDescription(activeVar, node.data, paperInsights?.expandedDescription);\n      callbackFunc(updatedTreeData);\n      resolve(updatedTreeData); // Return the updated data\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\nconst expandGraph = async (node, callbackFunc, activeVar) => {\n  const expandedGraphData = await expandGraphWithNewNodes(node.data.id);\n  const newTreeData = mergeData(node.data.id, activeVar, expandedGraphData);\n  callbackFunc(newTreeData)\n}\n\n// Main component\nconst Graph = () => {\n  const { scale, translate, handleNodeClick, currentNode, setLoading, treeData, setTreeData } = useContext(NodeContext);\n\n  useEffect(() => {\n    if (!currentNode) return;\n\n    const fetchData = async () => {\n      try {\n        if (currentNode && currentNode.data) {\n          setLoading(true);\n          const updatedTreeData = await getLongDesc(currentNode, setTreeData, treeData);\n          await expandGraph(currentNode, setTreeData, updatedTreeData);\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('An error occurred while fetching data:', error);\n      }\n    };\n\n    fetchData();\n  }, [currentNode]);\n\n\n  const onClick = (nodeData) => {\n    handleNodeClick(nodeData);\n  };\n\n  const [hoveredNode, setHoveredNode] = useState(null);\n\n  const handleMouseOver = (event, node) => {\n    setHoveredNode(node);\n  };\n\n  const handleMouseOut = () => {\n    setHoveredNode(null);\n  };\n\n\n  return (\n    <div className=\"graph\" style={{ transform: `scale(${scale})` }}>\n      {treeData && (\n        <Tree\n          data={treeData}\n          translate={translate}\n          onNodeClick={onClick}\n\n          separation={{ siblings: 1, nonSiblings: 1 }}\n          // pathFunc=\"step\"\n          rootNodeClassName=\"node__root\"\n          branchNodeClassName=\"node__branch\"\n          leafNodeClassName=\"node__leaf\"\n          onMouseOver={handleMouseOver}\n          onMouseOut={handleMouseOut}\n          nodeLabelComponent={{\n            render: <CustomNodeLabel hoveredNode={hoveredNode} />,\n            foreignObjectWrapper: {\n              x: -50,\n              y: -50,\n            },\n          }}\n    \n        />\n      )}\n    </div>\n  );\n};\n\nconst CustomNodeLabel = ({ nodeData, hoveredNode }) => {\n  const isHovered = nodeData === hoveredNode;\n  const size = isHovered ? 20 : 10;\n  const fontSize = isHovered ? '16px' : '12px';\n\n  return (\n    <foreignObject width={size} height={size}>\n      <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', width: '100%', height: '100%' }}>\n        <span style={{ fontSize, color: isHovered ? 'red' : 'black' }}>\n          {nodeData.name}\n        </span>\n      </div>\n    </foreignObject>\n  );\n};\n\nexport default Graph;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
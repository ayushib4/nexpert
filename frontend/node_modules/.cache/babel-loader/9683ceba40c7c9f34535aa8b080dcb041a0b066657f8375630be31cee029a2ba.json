{"ast":null,"code":"var _jsxFileName = \"/Users/ayushi/Desktop/repos/nexpert-frontend/src/components/Graph.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport Tree from 'react-d3-tree';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { NodeContext } from '../NodeContext.js';\nimport { getLongDescription, expandGraphWithNewNodes } from '../api/apiCalls.js'; // or wherever your API functions are stored\nimport './styles/Graph.css';\n\n// Helper functions\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction mergeData(nodeId, treeData, expandedData) {\n  // Function to recursively search for a node\n  function findNode(node) {\n    if (node.id === nodeId) {\n      var _node$children;\n      // Node found, append children\n      node.children = (_node$children = node.children) === null || _node$children === void 0 ? void 0 : _node$children.concat(expandedData);\n    } else if (node.children) {\n      // Node not found, search children\n      node.children.forEach(findNode);\n    }\n  }\n\n  // Make a deep copy of the tree data and search it\n  const newTreeData = cloneDeep(treeData);\n  findNode(newTreeData);\n  return newTreeData;\n}\n\n// Function to recursively update node description\nfunction updateDescription(node, currentNode, longDescription) {\n  if (node.id === currentNode.id) {\n    // Return a new object for the node\n    return {\n      ...node,\n      description: longDescription\n    };\n  }\n  if (node.children) {\n    // Iterate through children, creating new objects for any that have changed\n    return {\n      ...node,\n      children: node.children.map(child => updateDescription(child, currentNode, longDescription))\n    };\n  }\n  // No changes to this node or its children\n  return node;\n}\n;\nconst getLongDesc = (node, callbackFunc, activeVar) => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const paperInsights = await getLongDescription(node); // Add any necessary arguments\n      // Update node description in treeData\n      const updatedTreeData = updateDescription(activeVar, node.data, paperInsights === null || paperInsights === void 0 ? void 0 : paperInsights.expandedDescription);\n      callbackFunc(updatedTreeData);\n      resolve(updatedTreeData); // Return the updated data\n    } catch (error) {\n      reject(error);\n    }\n  });\n};\nconst expandGraph = async (node, callbackFunc, activeVar) => {\n  const expandedGraphData = await expandGraphWithNewNodes(node.data.id);\n  const newTreeData = mergeData(node.data.id, activeVar, expandedGraphData);\n  callbackFunc(newTreeData);\n};\n\n// Main component\nconst Graph = () => {\n  _s();\n  const {\n    scale,\n    translate,\n    handleNodeClick,\n    currentNode,\n    setLoading,\n    treeData,\n    setTreeData\n  } = useContext(NodeContext);\n  useEffect(() => {\n    if (!currentNode) return;\n    const fetchData = async () => {\n      try {\n        if (currentNode && currentNode.data) {\n          setLoading(true);\n          const updatedTreeData = await getLongDesc(currentNode, setTreeData, treeData);\n          await expandGraph(currentNode, setTreeData, updatedTreeData);\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('An error occurred while fetching data:', error);\n      }\n    };\n    fetchData();\n  }, [currentNode]);\n  const onClick = nodeData => {\n    handleNodeClick(nodeData);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"graph\",\n    style: {\n      transform: `scale(${scale})`\n    },\n    children: treeData && /*#__PURE__*/_jsxDEV(Tree, {\n      data: treeData,\n      translate: translate,\n      onNodeClick: onClick,\n      separation: {\n        siblings: 1,\n        nonSiblings: 1\n      }\n      // pathFunc=\"step\"\n      ,\n      rootNodeClassName: \"node__root\",\n      branchNodeClassName: \"node__branch\",\n      leafNodeClassName: \"node__leaf\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 5\n  }, this);\n};\n_s(Graph, \"zaTW2ORpZIUeg1dSEZAQa2t6Am8=\");\n_c = Graph;\nexport default Graph;\nvar _c;\n$RefreshReg$(_c, \"Graph\");","map":{"version":3,"names":["React","useContext","useEffect","useState","Tree","cloneDeep","NodeContext","getLongDescription","expandGraphWithNewNodes","jsxDEV","_jsxDEV","mergeData","nodeId","treeData","expandedData","findNode","node","id","_node$children","children","concat","forEach","newTreeData","updateDescription","currentNode","longDescription","description","map","child","getLongDesc","callbackFunc","activeVar","Promise","resolve","reject","paperInsights","updatedTreeData","data","expandedDescription","error","expandGraph","expandedGraphData","Graph","_s","scale","translate","handleNodeClick","setLoading","setTreeData","fetchData","console","onClick","nodeData","className","style","transform","onNodeClick","separation","siblings","nonSiblings","rootNodeClassName","branchNodeClassName","leafNodeClassName","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/ayushi/Desktop/repos/nexpert-frontend/src/components/Graph.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport Tree from 'react-d3-tree';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { NodeContext } from '../NodeContext.js';\nimport { getLongDescription, expandGraphWithNewNodes } from '../api/apiCalls.js'; // or wherever your API functions are stored\nimport './styles/Graph.css';\n\n// Helper functions\nfunction mergeData(nodeId, treeData, expandedData) {\n  // Function to recursively search for a node\n  function findNode(node) {\n    if (node.id === nodeId) {\n      // Node found, append children\n      node.children = node.children?.concat(expandedData);\n    } else if (node.children) {\n      // Node not found, search children\n      node.children.forEach(findNode);\n    }\n  }\n\n  // Make a deep copy of the tree data and search it\n  const newTreeData = cloneDeep(treeData);\n  findNode(newTreeData);\n\n  return newTreeData;\n}\n\n// Function to recursively update node description\nfunction updateDescription(node, currentNode, longDescription) {\n  if (node.id === currentNode.id) {\n    // Return a new object for the node\n    return { ...node, description: longDescription };\n  }\n  if (node.children) {\n    // Iterate through children, creating new objects for any that have changed\n    return {\n      ...node,\n      children: node.children.map(child => updateDescription(child, currentNode, longDescription)),\n    };\n  }\n  // No changes to this node or its children\n  return node;\n};\n\nconst getLongDesc = (node, callbackFunc, activeVar) => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const paperInsights = await getLongDescription(node); // Add any necessary arguments\n      // Update node description in treeData\n      const updatedTreeData = updateDescription(activeVar, node.data, paperInsights?.expandedDescription);\n      callbackFunc(updatedTreeData);\n      resolve(updatedTreeData); // Return the updated data\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\nconst expandGraph = async (node, callbackFunc, activeVar) => {\n  const expandedGraphData = await expandGraphWithNewNodes(node.data.id);\n  const newTreeData = mergeData(node.data.id, activeVar, expandedGraphData);\n  callbackFunc(newTreeData)\n}\n\n// Main component\nconst Graph = () => {\n  const { scale, translate, handleNodeClick, currentNode, setLoading, treeData, setTreeData } = useContext(NodeContext);\n\n  useEffect(() => {\n    if (!currentNode) return;\n    \n    const fetchData = async () => {\n      try {\n        if (currentNode && currentNode.data) {\n          setLoading(true);\n          const updatedTreeData = await getLongDesc(currentNode, setTreeData, treeData);\n          await expandGraph(currentNode, setTreeData, updatedTreeData);\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('An error occurred while fetching data:', error);\n      }\n    };\n\n    fetchData();\n  }, [currentNode]); \n\n\n  const onClick = (nodeData) => {\n    handleNodeClick(nodeData);\n  };\n\n  return (\n    <div className=\"graph\" style={{ transform: `scale(${scale})` }}>\n      {treeData && (\n        <Tree \n          data={treeData} \n          translate={translate}\n          onNodeClick={onClick} \n          separation={{ siblings: 1, nonSiblings: 1 }}\n          // pathFunc=\"step\"\n          rootNodeClassName=\"node__root\"\n          branchNodeClassName=\"node__branch\"\n          leafNodeClassName=\"node__leaf\"\n        />\n      )}\n    </div>\n  );\n};\n\nexport default Graph;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}